(self.webpackChunkui=self.webpackChunkui||[]).push([[5821],{5821:function(e,o,t){"use strict";t.r(o),t.d(o,{AddProcedurePageModule:function(){return k}});var r=t(1116),i=t(1041),n=t(4812),s=t(3337),u=t(4762),c=t(7570),d=t(5366),a=t(6659),l=t(8372),p=t(8057),m=t(1950),g=t(5431),h=t(3070),Z=t(3841),f=t(6489),v=t(5706),q=t(9550);function A(e,o){if(1&e&&(d.TgZ(0,"mat-option",12),d._uU(1),d.qZA()),2&e){const e=o.$implicit;d.Q6J("value",e),d.xp6(1),d.Oqu(e)}}function T(e,o){1&e&&(d.TgZ(0,"ion-text"),d.TgZ(1,"p",13),d._uU(2,"*Swipe right to delete a procedure."),d.qZA(),d.qZA())}function w(e,o){if(1&e){const e=d.EpF();d.TgZ(0,"ion-item-sliding"),d.TgZ(1,"ion-item-options",14),d.TgZ(2,"ion-item-option",15),d.NdJ("click",function(){const o=d.CHM(e).$implicit;return d.oxw().deleteProcedure(o)}),d._uU(3,"Delete"),d.qZA(),d.qZA(),d.TgZ(4,"ion-item"),d.TgZ(5,"mat-expansion-panel",16),d.TgZ(6,"mat-expansion-panel-header"),d.TgZ(7,"mat-panel-description"),d._uU(8),d.qZA(),d.qZA(),d.TgZ(9,"div",17),d.TgZ(10,"mat-form-field",18),d._UZ(11,"input",19),d.qZA(),d.TgZ(12,"mat-form-field"),d._UZ(13,"input",20),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){const e=o.$implicit;d.xp6(5),d.Q6J("formGroup",e),d.xp6(3),d.hij(" ",e.get("procedure").value," "),d.xp6(3),d.Q6J("value",e.get("count").value),d.xp6(2),d.Q6J("value",e.get("amount").value)}}function x(e,o){if(1&e&&(d.TgZ(0,"section",9),d.TgZ(1,"ion-item-group"),d.TgZ(2,"ion-item-divider"),d.TgZ(3,"ion-label"),d._uU(4),d.qZA(),d.qZA(),d.TgZ(5,"div",10),d.TgZ(6,"mat-form-field",11),d._UZ(7,"input",12),d.qZA(),d.TgZ(8,"mat-form-field"),d._UZ(9,"input",13),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){const e=o.$implicit;d.Q6J("formGroupName",o.index),d.xp6(4),d.Oqu(e)}}function b(e,o){if(1&e&&(d.TgZ(0,"ion-content"),d.TgZ(1,"form",6),d.TgZ(2,"div",7),d.YNc(3,x,10,2,"section",8),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("formGroup",e.procedureDetails),d.xp6(2),d.Q6J("ngForOf",e.procedures)}}let F=(()=>{class e{constructor(e,o,t,r,i,n,s){this.modalController=e,this.toastController=o,this.authService=t,this.router=r,this.storage=i,this.treatmentsService=n,this.proceduresService=s,this.hospitals=[],this.allProcedures=[],this.hospital$=new c.w}ngOnInit(){this.initializeForms()}ionViewWillEnter(){this.initializeForms()}ionViewWillLeave(){this.initializeForms(),this.hospital$.unsubscribe()}getProcedures(e){return this.proceduresService.getProcedures(e)}initializeForms(){this.addProcedureForm=new i.cw({procedures:new i.NI([],[i.kI.required])}),this.procedureForm=new i.cw({procedures:new i.Oe([])}),this.hospital$=this.treatmentsService.getSelectedHospital().subscribe(e=>(0,u.mG)(this,void 0,void 0,function*(){if(e){const o=yield this.getProcedures(e.id).toPromise();this.allProcedures=o.map(e=>e.name)}else this.router.navigateByUrl("").then()}))}openProcedureDetailsDialog(){return(0,u.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:N,componentProps:{procedures:this.addProcedureForm.get("procedures").value}});yield e.present();const{data:o}=yield e.onDidDismiss();"dismissed"!==o&&this.addProcedure(o)})}addProcedure(e){const o=e.value;this.proceduresService.addProcedures(o);const t=this.procedureForm.get("procedures");o.forEach(e=>{const o=new i.cw({procedure:new i.NI(e.procedure,[i.kI.required]),count:new i.NI(e.count,[i.kI.min(1)]),amount:new i.NI(e.amount,[i.kI.required,i.kI.min(0)])});t.controls.push(o)})}submit(){this.procedureForm.valid&&(this.authService.showLoader("Saving procedures").then(),setTimeout(()=>{this.router.navigateByUrl("procedures").then(()=>this.authService.dismissLoader())},1e3))}presentToast(e){return(0,u.mG)(this,void 0,void 0,function*(){const o=yield this.toastController.create({message:e,duration:2e3});yield o.present()})}deleteProcedure(e){this.proceduresService.removeProcedure(e.value.procedure);const o=this.procedureForm.get("procedures"),t=o.controls.reduce((e,o)=>(e.push(o.value.name),e),[]).indexOf(e.id);o.controls.splice(t,1)}}return e.\u0275fac=function(o){return new(o||e)(d.Y36(n.IN),d.Y36(n.yF),d.Y36(a.e),d.Y36(s.F0),d.Y36(l.Ke),d.Y36(p.z),d.Y36(m.e))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-add-procedure"]],decls:21,vars:8,consts:[[3,"pageName"],["size","12",1,"fixed-form"],[1,"single-line-container","flex-md-row",3,"formGroup"],["formControlName","procedures","multiple","","required",""],[3,"value",4,"ngFor","ngForOf"],["color","secondary","type","button",3,"disabled","click"],[4,"ngIf"],["size","12",2,"margin-top","45%"],[3,"formGroup","ngSubmit"],[4,"ngFor","ngForOf"],[1,"bottom-fixed-div"],["type","submit",1,"w-100",3,"disabled"],[3,"value"],[1,"hint-text","mt-5","mb-0","ml-1"],["side","start"],["color","danger",3,"click"],[3,"formGroup"],[1,"flex-row"],[2,"width","20%","margin-right","8%"],["matInput","","formControlName","count","placeholder","Count",3,"value"],["matInput","","formControlName","amount","placeholder","Amount",3,"value"]],template:function(e,o){1&e&&(d._UZ(0,"app-header",0),d.TgZ(1,"ion-content"),d.TgZ(2,"ion-grid"),d.TgZ(3,"ion-row"),d.TgZ(4,"ion-col",1),d.TgZ(5,"form",2),d.TgZ(6,"mat-form-field"),d.TgZ(7,"mat-label"),d._uU(8,"Select Procedures"),d.qZA(),d.TgZ(9,"mat-select",3),d.YNc(10,A,2,2,"mat-option",4),d.qZA(),d.qZA(),d.TgZ(11,"ion-button",5),d.NdJ("click",function(){return o.openProcedureDetailsDialog()}),d._uU(12,"Add"),d.qZA(),d.qZA(),d.YNc(13,T,3,0,"ion-text",6),d.qZA(),d.TgZ(14,"ion-col",7),d.TgZ(15,"mat-accordion"),d.TgZ(16,"form",8),d.NdJ("ngSubmit",function(){return o.submit()}),d.YNc(17,w,14,4,"ion-item-sliding",9),d.TgZ(18,"div",10),d.TgZ(19,"ion-button",11),d._uU(20,"Save"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.Q6J("pageName","Add a Procedure"),d.xp6(5),d.Q6J("formGroup",o.addProcedureForm),d.xp6(5),d.Q6J("ngForOf",o.allProcedures),d.xp6(1),d.Q6J("disabled",0===o.addProcedureForm.get("procedures").value.length),d.xp6(2),d.Q6J("ngIf",o.procedureForm.get("procedures").controls.length>0),d.xp6(3),d.Q6J("formGroup",o.procedureForm),d.xp6(1),d.Q6J("ngForOf",o.procedureForm.get("procedures").controls),d.xp6(2),d.Q6J("disabled",0===o.procedureForm.get("procedures").controls.length))},directives:[g.G,n.W2,n.jY,n.Nd,n.wI,i._Y,i.JL,i.sg,h.KE,h.hX,Z.gD,i.JJ,i.u,i.Q7,r.sg,n.YG,r.O5,f.pp,v.ey,n.yW,n.td,n.IK,n.u8,n.Ie,f.ib,f.yz,f.u4,q.Nt,i.Fj],styles:[".fixed-form[_ngcontent-%COMP%]{position:fixed;width:97%!important;background-color:#fff;z-index:999}"]}),e})(),N=(()=>{class e{constructor(e,o){this.modalController=e,this.toastController=o,this.procedureDetails=new i.cw({procedures:new i.Oe([])})}ngOnInit(){this.initializeForm()}presentToast(e){return(0,u.mG)(this,void 0,void 0,function*(){const o=yield this.toastController.create({message:e,duration:2e3});yield o.present()})}dismissModal(e){this.modalController.dismiss(e).then()}initializeForm(){this.procedures.forEach(e=>this.addProcedure(e))}addProcedure(e){const o=this.procedureDetails.get("procedures"),t=new i.cw({procedure:new i.NI(e),count:new i.NI(1,[i.kI.min(1),i.kI.required]),amount:new i.NI(100,[i.kI.min(0),i.kI.required])});o.controls.push(t)}submit(){if(this.procedureDetails.valid){const e=this.procedureDetails.get("procedures");this.dismissModal(e)}else this.presentToast("Form is invalid").then()}}return e.\u0275fac=function(o){return new(o||e)(d.Y36(n.IN),d.Y36(n.yF))},e.\u0275cmp=d.Xpm({type:e,selectors:[["procedure-details"]],inputs:{procedures:"procedures"},decls:11,vars:1,consts:[["translucent",""],["slot","end"],[3,"click"],[4,"ngIf"],[1,"bottom-fixed-div"],["type","submit","color","secondary",1,"w-100",3,"click"],[2,"margin-bottom","36px",3,"formGroup"],["formArrayName","procedures"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"flex-row","ml-5","mt-2",2,"width","90%"],[2,"width","20%","margin-right","4%"],["matInput","","formControlName","count","placeholder","Count","required",""],["matInput","","formControlName","amount","placeholder","Amount per procedure","required",""]],template:function(e,o){1&e&&(d.TgZ(0,"ion-header",0),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3,"Modal Content"),d.qZA(),d.TgZ(4,"ion-buttons",1),d.TgZ(5,"ion-button",2),d.NdJ("click",function(){return o.dismissModal("dismissed")}),d._uU(6,"Close"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(7,b,4,2,"ion-content",3),d.TgZ(8,"div",4),d.TgZ(9,"ion-button",5),d.NdJ("click",function(){return o.submit()}),d._uU(10,"Submit"),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.Q6J("ngIf",o.procedureDetails))},directives:[n.Gu,n.sr,n.wd,n.Sm,n.YG,r.O5,n.W2,i._Y,i.JL,i.sg,i.CE,r.sg,i.x0,n.Ub,n.rH,n.Q$,h.KE,q.Nt,i.Fj,i.JJ,i.u,i.Q7],encapsulation:2}),e})();const I=[{path:"",component:F}];let J=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.Bz.forChild(I)],s.Bz]}),e})();var P=t(5530),y=t(4369),C=t(2935);let k=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[r.ez,i.u5,i.UX,n.Pc,J,P.K,q.c,y.ot,Z.LD,f.To,C.Is]]}),e})()}}]);