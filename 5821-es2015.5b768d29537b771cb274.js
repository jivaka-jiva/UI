(self.webpackChunkui=self.webpackChunkui||[]).push([[5821],{5821:function(e,t,o){"use strict";o.r(t),o.d(t,{AddProcedurePageModule:function(){return _}});var r=o(1116),i=o(1041),n=o(4812),s=o(3337),a=o(4762),u=o(5366),d=o(6659),l=o(8372),c=o(5431),p=o(3070),m=o(3841),g=o(6489),h=o(5706),f=o(9550);function Z(e,t){if(1&e&&(u.TgZ(0,"mat-option",13),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(e)}}function v(e,t){if(1&e&&(u.TgZ(0,"mat-option",13),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(e)}}function q(e,t){1&e&&(u.TgZ(0,"ion-text"),u.TgZ(1,"p",14),u._uU(2,"*Swipe right to delete a procedure."),u.qZA(),u.qZA())}function A(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"ion-item-sliding"),u.TgZ(1,"ion-item-options",15),u.TgZ(2,"ion-item-option",16),u.NdJ("click",function(){const t=u.CHM(e).index;return u.oxw().deleteProcedure(t)}),u._uU(3,"Delete"),u.qZA(),u.qZA(),u.TgZ(4,"ion-item"),u.TgZ(5,"mat-expansion-panel",17),u.TgZ(6,"mat-expansion-panel-header"),u.TgZ(7,"mat-panel-title"),u._uU(8),u.qZA(),u.TgZ(9,"mat-panel-description"),u._uU(10),u.qZA(),u.qZA(),u.TgZ(11,"div",18),u.TgZ(12,"mat-form-field",19),u._UZ(13,"input",20),u.qZA(),u.TgZ(14,"mat-form-field"),u._UZ(15,"input",21),u.qZA(),u.TgZ(16,"mat-form-field",22),u._UZ(17,"input",23),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=t.$implicit;u.xp6(5),u.Q6J("formGroup",e),u.xp6(3),u.hij(" ",e.get("hospital").value," "),u.xp6(2),u.hij(" ",e.get("procedure").value," "),u.xp6(3),u.Q6J("value",e.get("count").value),u.xp6(2),u.Q6J("value",e.get("amount").value),u.xp6(2),u.Q6J("value",e.get("patient").value)}}function T(e,t){if(1&e&&(u.TgZ(0,"section",9),u.TgZ(1,"ion-item-group"),u.TgZ(2,"ion-item-divider"),u.TgZ(3,"ion-label"),u._uU(4),u.qZA(),u.qZA(),u.TgZ(5,"div",10),u.TgZ(6,"mat-form-field",11),u._UZ(7,"input",12),u.qZA(),u.TgZ(8,"mat-form-field"),u._UZ(9,"input",13),u.qZA(),u.TgZ(10,"mat-form-field",14),u._UZ(11,"input",15),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e){const e=t.$implicit;u.Q6J("formGroupName",t.index),u.xp6(4),u.Oqu(e)}}function w(e,t){if(1&e&&(u.TgZ(0,"ion-content"),u.TgZ(1,"form",6),u.TgZ(2,"div",7),u.YNc(3,T,12,2,"section",8),u.qZA(),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("formGroup",e.procedureDetails),u.xp6(2),u.Q6J("ngForOf",e.procedures)}}let I=(()=>{class e{constructor(e,t,o,r,i){this.modalController=e,this.toastController=t,this.authService=o,this.router=r,this.storage=i,this.hospitals=[],this.allProcedures=["Inject","Sedate","Root canal","Eye test"],this.storage.get("hospitals").then(e=>this.hospitals=e)}ngOnInit(){this.initializeForms()}ionViewWillEnter(){this.initializeForms(),this.addProcedureForm.get("hospital").valueChanges.subscribe(e=>{this.addProcedureForm.get("procedures").enable(),this.addProcedureForm.get("procedures").patchValue([])})}ionViewWillLeave(){this.initializeForms()}initializeForms(){this.addProcedureForm=new i.cw({hospital:new i.NI("",[i.kI.required]),procedures:new i.NI({value:[],disabled:!0},[i.kI.required])}),this.procedureForm=new i.cw({procedures:new i.Oe([])})}openProcedureDetailsDialog(){return(0,a.mG)(this,void 0,void 0,function*(){const e=yield this.modalController.create({component:N,componentProps:{procedures:this.addProcedureForm.get("procedures").value}});yield e.present();const{data:t}=yield e.onDidDismiss();"dismissed"!==t&&this.addProcedure(t)})}addProcedure(e){const t=this.procedureForm.get("procedures");e.forEach(e=>{const o=new i.cw({hospital:new i.NI(this.addProcedureForm.get("hospital").value,[i.kI.required]),procedure:new i.NI(e.value.procedure,[i.kI.required]),count:new i.NI(e.value.count,[i.kI.min(1)]),amount:new i.NI(e.value.amount,[i.kI.required,i.kI.min(0)]),patient:new i.NI(e.value.patient)});t.controls.push(o)})}submit(){this.procedureForm.valid&&(this.saveData(),this.authService.showLoader("Saving procedures").then(),setTimeout(()=>{this.router.navigateByUrl("").then(()=>this.authService.dismissLoader())},1e3))}saveData(){return(0,a.mG)(this,void 0,void 0,function*(){let e=parseInt(yield this.storage.get("total_fees_this_month"),10)||0,t=parseInt(yield this.storage.get("total_procedures"),10)||0;const o=yield this.storage.get("hospitals"),r={};yield o.forEach(e=>(0,a.mG)(this,void 0,void 0,function*(){r[e]=(yield this.storage.get(e))||0})),this.procedureForm.get("procedures").controls.forEach(o=>{e+=parseInt(o.value.amount,10)*parseInt(o.value.count,10),t+=parseInt(o.value.count,10),r[o.value.hospital]=parseInt(r[o.value.hospital],10)+parseInt(o.value.amount,10)*parseInt(o.value.count,10)}),yield this.storage.set("total_fees_this_month",e+""),yield this.storage.set("total_procedures",t+""),yield o.forEach(e=>(0,a.mG)(this,void 0,void 0,function*(){yield this.storage.set(e,r[e])}))})}presentToast(e){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.toastController.create({message:e,duration:2e3});yield t.present()})}deleteProcedure(e){this.procedureForm.get("procedures").controls.splice(e,1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(n.IN),u.Y36(n.yF),u.Y36(d.e),u.Y36(s.F0),u.Y36(l.Ke))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-add-procedure"]],decls:26,vars:9,consts:[[3,"pageName"],["size","12",1,"fixed-form"],[1,"single-line-container","flex-md-row",3,"formGroup"],["formControlName","hospital","required",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","procedures","multiple","","required",""],["color","secondary","type","button",3,"disabled","click"],[4,"ngIf"],["size","12",2,"margin-top","15rem"],[3,"formGroup","ngSubmit"],[4,"ngFor","ngForOf"],[1,"bottom-fixed-div"],["type","submit",1,"w-100",3,"disabled"],[3,"value"],[1,"hint-text","mt-5","mb-0","ml-1"],["side","start"],["color","danger",3,"click"],[3,"formGroup"],[1,"flex-row"],[2,"width","20%","margin-right","8%"],["matInput","","formControlName","count","placeholder","Count",3,"value"],["matInput","","formControlName","amount","placeholder","Amount",3,"value"],[2,"width","100%"],["matInput","","formControlName","patient","placeholder","Patient's name",3,"value"]],template:function(e,t){1&e&&(u._UZ(0,"app-header",0),u.TgZ(1,"ion-content"),u.TgZ(2,"ion-grid"),u.TgZ(3,"ion-row"),u.TgZ(4,"ion-col",1),u.TgZ(5,"form",2),u.TgZ(6,"mat-form-field"),u.TgZ(7,"mat-label"),u._uU(8,"Select hospital"),u.qZA(),u.TgZ(9,"mat-select",3),u.YNc(10,Z,2,2,"mat-option",4),u.qZA(),u.qZA(),u.TgZ(11,"mat-form-field"),u.TgZ(12,"mat-label"),u._uU(13,"Select Procedures"),u.qZA(),u.TgZ(14,"mat-select",5),u.YNc(15,v,2,2,"mat-option",4),u.qZA(),u.qZA(),u.TgZ(16,"ion-button",6),u.NdJ("click",function(){return t.openProcedureDetailsDialog()}),u._uU(17,"Add"),u.qZA(),u.qZA(),u.YNc(18,q,3,0,"ion-text",7),u.qZA(),u.TgZ(19,"ion-col",8),u.TgZ(20,"mat-accordion"),u.TgZ(21,"form",9),u.NdJ("ngSubmit",function(){return t.submit()}),u.YNc(22,A,18,6,"ion-item-sliding",10),u.TgZ(23,"div",11),u.TgZ(24,"ion-button",12),u._uU(25,"Save"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Q6J("pageName","Add a Procedure"),u.xp6(5),u.Q6J("formGroup",t.addProcedureForm),u.xp6(5),u.Q6J("ngForOf",t.hospitals),u.xp6(5),u.Q6J("ngForOf",t.allProcedures),u.xp6(1),u.Q6J("disabled",0===t.addProcedureForm.get("procedures").value.length),u.xp6(2),u.Q6J("ngIf",t.procedureForm.get("procedures").controls.length>0),u.xp6(3),u.Q6J("formGroup",t.procedureForm),u.xp6(1),u.Q6J("ngForOf",t.procedureForm.get("procedures").controls),u.xp6(2),u.Q6J("disabled",0===t.procedureForm.get("procedures").controls.length))},directives:[c.G,n.W2,n.jY,n.Nd,n.wI,i._Y,i.JL,i.sg,p.KE,p.hX,m.gD,i.JJ,i.u,i.Q7,r.sg,n.YG,r.O5,g.pp,h.ey,n.yW,n.td,n.IK,n.u8,n.Ie,g.ib,g.yz,g.yK,g.u4,f.Nt,i.Fj],styles:[".fixed-form[_ngcontent-%COMP%]{position:fixed;width:97%!important;background-color:#fff;z-index:999}"]}),e})(),N=(()=>{class e{constructor(e,t){this.modalController=e,this.toastController=t,this.procedureDetails=new i.cw({procedures:new i.Oe([])})}ngOnInit(){this.initializeForm()}presentToast(e){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.toastController.create({message:e,duration:2e3});yield t.present()})}dismissModal(e){this.modalController.dismiss(e).then()}initializeForm(){this.procedures.forEach(e=>this.addProcedure(e))}addProcedure(e){const t=this.procedureDetails.get("procedures"),o=new i.cw({procedure:new i.NI(e),count:new i.NI(1,[i.kI.min(1),i.kI.required]),amount:new i.NI(100,[i.kI.min(0),i.kI.required]),patient:new i.NI("")});t.controls.push(o)}submit(){if(this.procedureDetails.valid){const e=this.procedureDetails.get("procedures");this.dismissModal(e.controls)}else this.presentToast("Form is invalid").then()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(n.IN),u.Y36(n.yF))},e.\u0275cmp=u.Xpm({type:e,selectors:[["procedure-details"]],inputs:{procedures:"procedures"},decls:11,vars:1,consts:[["translucent",""],["slot","end"],[3,"click"],[4,"ngIf"],[1,"bottom-fixed-div"],["type","submit","color","secondary",1,"w-100",3,"click"],[2,"margin-bottom","36px",3,"formGroup"],["formArrayName","procedures"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"flex-row","ml-5","mt-2",2,"width","72%"],[2,"width","20%","margin-right","8%"],["matInput","","formControlName","count","placeholder","Count","required",""],["matInput","","formControlName","amount","placeholder","Amount per procedure","required",""],[2,"width","100%"],["matInput","","formControlName","patient","placeholder","Patient's name","required",""]],template:function(e,t){1&e&&(u.TgZ(0,"ion-header",0),u.TgZ(1,"ion-toolbar"),u.TgZ(2,"ion-title"),u._uU(3,"Modal Content"),u.qZA(),u.TgZ(4,"ion-buttons",1),u.TgZ(5,"ion-button",2),u.NdJ("click",function(){return t.dismissModal("dismissed")}),u._uU(6,"Close"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.YNc(7,w,4,2,"ion-content",3),u.TgZ(8,"div",4),u.TgZ(9,"ion-button",5),u.NdJ("click",function(){return t.submit()}),u._uU(10,"Submit"),u.qZA(),u.qZA()),2&e&&(u.xp6(7),u.Q6J("ngIf",t.procedureDetails))},directives:[n.Gu,n.sr,n.wd,n.Sm,n.YG,r.O5,n.W2,i._Y,i.JL,i.sg,i.CE,r.sg,i.x0,n.Ub,n.rH,n.Q$,p.KE,f.Nt,i.Fj,i.JJ,i.u,i.Q7],encapsulation:2}),e})();const x=[{path:"",component:I}];let F=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.Bz.forChild(x)],s.Bz]}),e})();var b=o(5530),y=o(4369),J=o(2935);let _=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.ez,i.u5,i.UX,n.Pc,F,b.K,f.c,y.ot,m.LD,g.To,J.Is]]}),e})()}}]);