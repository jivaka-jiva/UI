!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}(self.webpackChunkui=self.webpackChunkui||[]).push([[5821],{5821:function(t,n,o){"use strict";o.r(n),o.d(n,{AddProcedurePageModule:function(){return P}});var i=o(1116),a=o(1041),u=o(4812),s=o(3337),c=o(4762),d=o(5366),l=o(6659),p=o(8372),m=o(5431),f=o(3070),g=o(3841),h=o(6489),v=o(5706),Z=o(9550);function q(e,t){if(1&e&&(d.TgZ(0,"mat-option",13),d._uU(1),d.qZA()),2&e){var r=t.$implicit;d.Q6J("value",r),d.xp6(1),d.Oqu(r)}}function x(e,t){if(1&e&&(d.TgZ(0,"mat-option",13),d._uU(1),d.qZA()),2&e){var r=t.$implicit;d.Q6J("value",r),d.xp6(1),d.Oqu(r)}}function w(e,t){1&e&&(d.TgZ(0,"ion-text"),d.TgZ(1,"p",14),d._uU(2,"*Swipe right to delete a procedure."),d.qZA(),d.qZA())}function A(e,t){if(1&e){var r=d.EpF();d.TgZ(0,"ion-item-sliding"),d.TgZ(1,"ion-item-options",15),d.TgZ(2,"ion-item-option",16),d.NdJ("click",function(){var e=d.CHM(r).index;return d.oxw().deleteProcedure(e)}),d._uU(3,"Delete"),d.qZA(),d.qZA(),d.TgZ(4,"ion-item"),d.TgZ(5,"mat-expansion-panel",17),d.TgZ(6,"mat-expansion-panel-header"),d.TgZ(7,"mat-panel-title"),d._uU(8),d.qZA(),d.TgZ(9,"mat-panel-description"),d._uU(10),d.qZA(),d.qZA(),d.TgZ(11,"div",18),d.TgZ(12,"mat-form-field",19),d._UZ(13,"input",20),d.qZA(),d.TgZ(14,"mat-form-field"),d._UZ(15,"input",21),d.qZA(),d.TgZ(16,"mat-form-field",22),d._UZ(17,"input",23),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var n=t.$implicit;d.xp6(5),d.Q6J("formGroup",n),d.xp6(3),d.hij(" ",n.get("hospital").value," "),d.xp6(2),d.hij(" ",n.get("procedure").value," "),d.xp6(3),d.Q6J("value",n.get("count").value),d.xp6(2),d.Q6J("value",n.get("amount").value),d.xp6(2),d.Q6J("value",n.get("patient").value)}}function T(e,t){if(1&e&&(d.TgZ(0,"section",9),d.TgZ(1,"ion-item-group"),d.TgZ(2,"ion-item-divider"),d.TgZ(3,"ion-label"),d._uU(4),d.qZA(),d.qZA(),d.TgZ(5,"div",10),d.TgZ(6,"mat-form-field",11),d._UZ(7,"input",12),d.qZA(),d.TgZ(8,"mat-form-field"),d._UZ(9,"input",13),d.qZA(),d.TgZ(10,"mat-form-field",14),d._UZ(11,"input",15),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){var r=t.$implicit;d.Q6J("formGroupName",t.index),d.xp6(4),d.Oqu(r)}}function k(e,t){if(1&e&&(d.TgZ(0,"ion-content"),d.TgZ(1,"form",6),d.TgZ(2,"div",7),d.YNc(3,T,12,2,"section",8),d.qZA(),d.qZA(),d.qZA()),2&e){var r=d.oxw();d.xp6(1),d.Q6J("formGroup",r.procedureDetails),d.xp6(2),d.Q6J("ngForOf",r.procedures)}}var I,b=function(){var t=function(){function t(r,n,o,i,a){var u=this;e(this,t),this.modalController=r,this.toastController=n,this.authService=o,this.router=i,this.storage=a,this.hospitals=[],this.allProcedures=["Inject","Sedate","Root canal","Eye test"],this.storage.get("hospitals").then(function(e){return u.hospitals=e})}return r(t,[{key:"ngOnInit",value:function(){this.initializeForms()}},{key:"ionViewWillEnter",value:function(){var e=this;this.initializeForms(),this.addProcedureForm.get("hospital").valueChanges.subscribe(function(t){e.addProcedureForm.get("procedures").enable(),e.addProcedureForm.get("procedures").patchValue([])})}},{key:"ionViewWillLeave",value:function(){this.initializeForms()}},{key:"initializeForms",value:function(){this.addProcedureForm=new a.cw({hospital:new a.NI("",[a.kI.required]),procedures:new a.NI({value:[],disabled:!0},[a.kI.required])}),this.procedureForm=new a.cw({procedures:new a.Oe([])})}},{key:"openProcedureDetailsDialog",value:function(){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:N,componentProps:{procedures:this.addProcedureForm.get("procedures").value}});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.next=7,t.onDidDismiss();case 7:r=e.sent,"dismissed"!==(n=r.data)&&this.addProcedure(n);case 10:case"end":return e.stop()}},e,this)}))}},{key:"addProcedure",value:function(e){var t=this,r=this.procedureForm.get("procedures");e.forEach(function(e){var n=new a.cw({hospital:new a.NI(t.addProcedureForm.get("hospital").value,[a.kI.required]),procedure:new a.NI(e.value.procedure,[a.kI.required]),count:new a.NI(e.value.count,[a.kI.min(1)]),amount:new a.NI(e.value.amount,[a.kI.required,a.kI.min(0)]),patient:new a.NI(e.value.patient)});r.controls.push(n)})}},{key:"submit",value:function(){var e=this;this.procedureForm.valid&&(this.saveData(),this.authService.showLoader("Saving procedures").then(),setTimeout(function(){e.router.navigateByUrl("").then(function(){return e.authService.dismissLoader()})},1e3))}},{key:"saveData",value:function(){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n,o,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t1=parseInt,e.next=3,this.storage.get("total_fees_this_month");case 3:if(e.t2=e.sent,e.t0=(0,e.t1)(e.t2,10),e.t0){e.next=7;break}e.t0=0;case 7:return t=e.t0,e.t4=parseInt,e.next=11,this.storage.get("total_procedures");case 11:if(e.t5=e.sent,e.t3=(0,e.t4)(e.t5,10),e.t3){e.next=15;break}e.t3=0;case 15:return r=e.t3,e.next=18,this.storage.get("hospitals");case 18:return n=e.sent,o={},e.next=22,n.forEach(function(e){return(0,c.mG)(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.storage.get(e);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=0;case 5:o[e]=t.t0;case 6:case"end":return t.stop()}},t,this)}))});case 22:return this.procedureForm.get("procedures").controls.forEach(function(e){t+=parseInt(e.value.amount,10)*parseInt(e.value.count,10),r+=parseInt(e.value.count,10),o[e.value.hospital]=parseInt(o[e.value.hospital],10)+parseInt(e.value.amount,10)*parseInt(e.value.count,10)}),e.next=25,this.storage.set("total_fees_this_month",t+"");case 25:return e.next=27,this.storage.set("total_procedures",r+"");case 27:return e.next=29,n.forEach(function(e){return(0,c.mG)(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.storage.set(e,o[e]);case 2:case"end":return t.stop()}},t,this)}))});case 29:case"end":return e.stop()}},e,this)}))}},{key:"presentToast",value:function(e){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastController.create({message:e,duration:2e3});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"deleteProcedure",value:function(e){this.procedureForm.get("procedures").controls.splice(e,1)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(u.IN),d.Y36(u.yF),d.Y36(l.e),d.Y36(s.F0),d.Y36(p.Ke))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-add-procedure"]],decls:26,vars:9,consts:[[3,"pageName"],["size","12",1,"fixed-form"],[1,"single-line-container","flex-md-row",3,"formGroup"],["formControlName","hospital","required",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","procedures","multiple","","required",""],["color","secondary","type","button",3,"disabled","click"],[4,"ngIf"],["size","12",2,"margin-top","15rem"],[3,"formGroup","ngSubmit"],[4,"ngFor","ngForOf"],[1,"bottom-fixed-div"],["type","submit",1,"w-100",3,"disabled"],[3,"value"],[1,"hint-text","mt-5","mb-0","ml-1"],["side","start"],["color","danger",3,"click"],[3,"formGroup"],[1,"flex-row"],[2,"width","20%","margin-right","8%"],["matInput","","formControlName","count","placeholder","Count",3,"value"],["matInput","","formControlName","amount","placeholder","Amount",3,"value"],[2,"width","100%"],["matInput","","formControlName","patient","placeholder","Patient's name",3,"value"]],template:function(e,t){1&e&&(d._UZ(0,"app-header",0),d.TgZ(1,"ion-content"),d.TgZ(2,"ion-grid"),d.TgZ(3,"ion-row"),d.TgZ(4,"ion-col",1),d.TgZ(5,"form",2),d.TgZ(6,"mat-form-field"),d.TgZ(7,"mat-label"),d._uU(8,"Select hospital"),d.qZA(),d.TgZ(9,"mat-select",3),d.YNc(10,q,2,2,"mat-option",4),d.qZA(),d.qZA(),d.TgZ(11,"mat-form-field"),d.TgZ(12,"mat-label"),d._uU(13,"Select Procedures"),d.qZA(),d.TgZ(14,"mat-select",5),d.YNc(15,x,2,2,"mat-option",4),d.qZA(),d.qZA(),d.TgZ(16,"ion-button",6),d.NdJ("click",function(){return t.openProcedureDetailsDialog()}),d._uU(17,"Add"),d.qZA(),d.qZA(),d.YNc(18,w,3,0,"ion-text",7),d.qZA(),d.TgZ(19,"ion-col",8),d.TgZ(20,"mat-accordion"),d.TgZ(21,"form",9),d.NdJ("ngSubmit",function(){return t.submit()}),d.YNc(22,A,18,6,"ion-item-sliding",10),d.TgZ(23,"div",11),d.TgZ(24,"ion-button",12),d._uU(25,"Save"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.Q6J("pageName","Add a Procedure"),d.xp6(5),d.Q6J("formGroup",t.addProcedureForm),d.xp6(5),d.Q6J("ngForOf",t.hospitals),d.xp6(5),d.Q6J("ngForOf",t.allProcedures),d.xp6(1),d.Q6J("disabled",0===t.addProcedureForm.get("procedures").value.length),d.xp6(2),d.Q6J("ngIf",t.procedureForm.get("procedures").controls.length>0),d.xp6(3),d.Q6J("formGroup",t.procedureForm),d.xp6(1),d.Q6J("ngForOf",t.procedureForm.get("procedures").controls),d.xp6(2),d.Q6J("disabled",0===t.procedureForm.get("procedures").controls.length))},directives:[m.G,u.W2,u.jY,u.Nd,u.wI,a._Y,a.JL,a.sg,f.KE,f.hX,g.gD,a.JJ,a.u,a.Q7,i.sg,u.YG,i.O5,h.pp,v.ey,u.yW,u.td,u.IK,u.u8,u.Ie,h.ib,h.yz,h.yK,h.u4,Z.Nt,a.Fj],styles:[".fixed-form[_ngcontent-%COMP%]{position:fixed;width:97%!important;background-color:#fff;z-index:999}"]}),t}(),N=function(){var t=function(){function t(r,n){e(this,t),this.modalController=r,this.toastController=n,this.procedureDetails=new a.cw({procedures:new a.Oe([])})}return r(t,[{key:"ngOnInit",value:function(){this.initializeForm()}},{key:"presentToast",value:function(e){return(0,c.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastController.create({message:e,duration:2e3});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"dismissModal",value:function(e){this.modalController.dismiss(e).then()}},{key:"initializeForm",value:function(){var e=this;this.procedures.forEach(function(t){return e.addProcedure(t)})}},{key:"addProcedure",value:function(e){var t=this.procedureDetails.get("procedures"),r=new a.cw({procedure:new a.NI(e),count:new a.NI(1,[a.kI.min(1),a.kI.required]),amount:new a.NI(100,[a.kI.min(0),a.kI.required]),patient:new a.NI("")});t.controls.push(r)}},{key:"submit",value:function(){if(this.procedureDetails.valid){var e=this.procedureDetails.get("procedures");this.dismissModal(e.controls)}else this.presentToast("Form is invalid").then()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(u.IN),d.Y36(u.yF))},t.\u0275cmp=d.Xpm({type:t,selectors:[["procedure-details"]],inputs:{procedures:"procedures"},decls:11,vars:1,consts:[["translucent",""],["slot","end"],[3,"click"],[4,"ngIf"],[1,"bottom-fixed-div"],["type","submit","color","secondary",1,"w-100",3,"click"],[2,"margin-bottom","36px",3,"formGroup"],["formArrayName","procedures"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"flex-row","ml-5","mt-2",2,"width","72%"],[2,"width","20%","margin-right","8%"],["matInput","","formControlName","count","placeholder","Count","required",""],["matInput","","formControlName","amount","placeholder","Amount per procedure","required",""],[2,"width","100%"],["matInput","","formControlName","patient","placeholder","Patient's name","required",""]],template:function(e,t){1&e&&(d.TgZ(0,"ion-header",0),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3,"Modal Content"),d.qZA(),d.TgZ(4,"ion-buttons",1),d.TgZ(5,"ion-button",2),d.NdJ("click",function(){return t.dismissModal("dismissed")}),d._uU(6,"Close"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(7,k,4,2,"ion-content",3),d.TgZ(8,"div",4),d.TgZ(9,"ion-button",5),d.NdJ("click",function(){return t.submit()}),d._uU(10,"Submit"),d.qZA(),d.qZA()),2&e&&(d.xp6(7),d.Q6J("ngIf",t.procedureDetails))},directives:[u.Gu,u.sr,u.wd,u.Sm,u.YG,i.O5,u.W2,a._Y,a.JL,a.sg,a.CE,i.sg,a.x0,u.Ub,u.rH,u.Q$,f.KE,Z.Nt,a.Fj,a.JJ,a.u,a.Q7],encapsulation:2}),t}(),F=[{path:"",component:b}],y=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[s.Bz.forChild(F)],s.Bz]}),t}(),J=o(5530),_=o(4369),C=o(2935),P=((I=function t(){e(this,t)}).\u0275fac=function(e){return new(e||I)},I.\u0275mod=d.oAB({type:I}),I.\u0275inj=d.cJS({imports:[[i.ez,a.u5,a.UX,u.Pc,y,J.K,Z.c,_.ot,g.LD,h.To,C.Is]]}),I)}}])}();